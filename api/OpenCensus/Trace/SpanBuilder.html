<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: OpenCensus::Trace::SpanBuilder
  
    &mdash; OpenCensus
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "OpenCensus::Trace::SpanBuilder";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../_index.html">Index (S)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../OpenCensus.html" title="OpenCensus (module)">OpenCensus</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Trace.html" title="OpenCensus::Trace (module)">Trace</a></span></span>
     &raquo; 
    <span class="title">SpanBuilder</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: OpenCensus::Trace::SpanBuilder
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">OpenCensus::Trace::SpanBuilder</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/opencensus/trace/span_builder.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Span represents a single span within a request trace.</p>


  </div>
</div>
<div class="tags">
  

</div>
  
    <h2>
      Constant Summary
      <small><a href="#" class="constants_summary_toggle">collapse</a></small>
    </h2>

    <dl class="constants">
      
        <dt id="TYPE_UNSPECIFIED-constant" class="">TYPE_UNSPECIFIED =
          <div class="docstring">
  <div class="discussion">
    
<p>This value may be used as an event type or a link type, and indicates that
the type is unknown.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
      
    </li>
  
</ul>

</div>
        </dt>
        <dd><pre class="code"><span class='symbol'>:TYPE_UNSPECIFIED</span></pre></dd>
      
        <dt id="SENT-constant" class="">SENT =
          <div class="docstring">
  <div class="discussion">
    
<p>An event type, indicating a sent message.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
      
    </li>
  
</ul>

</div>
        </dt>
        <dd><pre class="code"><span class='symbol'>:SENT</span></pre></dd>
      
        <dt id="RECEIVED-constant" class="">RECEIVED =
          <div class="docstring">
  <div class="discussion">
    
<p>An event type, indicating a received message.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
      
    </li>
  
</ul>

</div>
        </dt>
        <dd><pre class="code"><span class='symbol'>:RECEIVED</span></pre></dd>
      
        <dt id="CHILD_LINKED_SPAN-constant" class="">CHILD_LINKED_SPAN =
          <div class="docstring">
  <div class="discussion">
    
<p>A link type, indicating the linked span is a child of the current span.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
      
    </li>
  
</ul>

</div>
        </dt>
        <dd><pre class="code"><span class='symbol'>:CHILD_LINKED_SPAN</span></pre></dd>
      
        <dt id="PARENT_LINKED_SPAN-constant" class="">PARENT_LINKED_SPAN =
          <div class="docstring">
  <div class="discussion">
    
<p>A link type, indicating the linked span is a parent of the current span.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
      
    </li>
  
</ul>

</div>
        </dt>
        <dd><pre class="code"><span class='symbol'>:PARENT_LINKED_SPAN</span></pre></dd>
      
        <dt id="SPAN_KIND_UNSPECIFIED-constant" class="">SPAN_KIND_UNSPECIFIED =
          <div class="docstring">
  <div class="discussion">
    
<p>A span kind, indicating that the span is either neither a server nor a
client, or is unknown.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
      
    </li>
  
</ul>

</div>
        </dt>
        <dd><pre class="code"><span class='symbol'>:SPAN_KIND_UNSPECIFIED</span></pre></dd>
      
        <dt id="SERVER-constant" class="">SERVER =
          <div class="docstring">
  <div class="discussion">
    
<p>A span kind, indicating that the span covers server-side handling of an RPC
or other remote network request.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
      
    </li>
  
</ul>

</div>
        </dt>
        <dd><pre class="code"><span class='symbol'>:SERVER</span></pre></dd>
      
        <dt id="CLIENT-constant" class="">CLIENT =
          <div class="docstring">
  <div class="discussion">
    
<p>A span kind, indicating that the span covers the client-side wrapper around
an RPC or other remote request.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
      
    </li>
  
</ul>

</div>
        </dt>
        <dd><pre class="code"><span class='symbol'>:CLIENT</span></pre></dd>
      
    </dl>
  




  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#context-instance_method" title="#context (instance method)">#<strong>context</strong>  &#x21d2; SpanContext </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The context that can build children of this span.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#end_time-instance_method" title="#end_time (instance method)">#<strong>end_time</strong>  &#x21d2; Time<sup>?</sup> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The end time of the span.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#kind-instance_method" title="#kind (instance method)">#<strong>kind</strong>  &#x21d2; Symbol </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The kind of span.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#name-instance_method" title="#name (instance method)">#<strong>name</strong>  &#x21d2; String, TruncatableString </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A description of the span&#39;s operation.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#start_time-instance_method" title="#start_time (instance method)">#<strong>start_time</strong>  &#x21d2; Time<sup>?</sup> </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The start time of the span.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#finish!-instance_method" title="#finish! (instance method)">#<strong>finish!</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Finish this span by setting the end time to the current time.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#finished%3F-instance_method" title="#finished? (instance method)">#<strong>finished?</strong>  &#x21d2; boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Whether this span is finished (i.e. has both a start and end time).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#parent_span_id-instance_method" title="#parent_span_id (instance method)">#<strong>parent_span_id</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The span ID of the parent, as a 16-character hex string, or the empty
string if this is a root span.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#put_annotation-instance_method" title="#put_annotation (instance method)">#<strong>put_annotation</strong>(description, attributes = {}, time: nil)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Add an event annotation with a timestamp.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#put_attribute-instance_method" title="#put_attribute (instance method)">#<strong>put_attribute</strong>(key, value)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Add an attribute to this span.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#put_link-instance_method" title="#put_link (instance method)">#<strong>put_link</strong>(trace_id, span_id, type, attributes = {})  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Add a pointer from the current span to another span, which may be in the
same trace or in a different trace.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#put_message_event-instance_method" title="#put_message_event (instance method)">#<strong>put_message_event</strong>(type, id, uncompressed_size, compressed_size: nil, time: nil)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Add an event describing a message sent/received between spans.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#sampled%3F-instance_method" title="#sampled? (instance method)">#<strong>sampled?</strong>  &#x21d2; boolean </a>
    

    
      (also: #sampled)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Sampling decision for this span.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#set_http_status-instance_method" title="#set_http_status (instance method)">#<strong>set_http_status</strong>(code, message = &quot;&quot;)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Set the optional final status for the span using an http status code.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#set_status-instance_method" title="#set_status (instance method)">#<strong>set_status</strong>(code, message = &quot;&quot;)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Set the optional final status for the span.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#span_id-instance_method" title="#span_id (instance method)">#<strong>span_id</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The span ID, as a 16-character hex string.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#start!-instance_method" title="#start! (instance method)">#<strong>start!</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Start this span by setting the start time to the current time.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#to_span-instance_method" title="#to_span (instance method)">#<strong>to_span</strong>(max_attributes: nil, max_stack_frames: nil, max_annotations: nil, max_message_events: nil, max_links: nil, max_string_length: nil, child_span_count: nil)  &#x21d2; Span </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Return a read-only version of this span.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#trace_id-instance_method" title="#trace_id (instance method)">#<strong>trace_id</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The trace ID, as a 32-character hex string.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#update_stack_trace-instance_method" title="#update_stack_trace (instance method)">#<strong>update_stack_trace</strong>(stack_trace = 0)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Set the stack trace for this span.</p>
</div></span>
  
</li>

      
    </ul>
  


  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="context-instance_method">
  
    #<strong>context</strong>  &#x21d2; <tt><span class='object_link'><a href="SpanContext.html" title="OpenCensus::Trace::SpanContext (class)">SpanContext</a></span></tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The context that can build children of this span.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="SpanContext.html" title="OpenCensus::Trace::SpanContext (class)">SpanContext</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


79
80
81</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/opencensus/trace/span_builder.rb', line 79</span>

<span class='kw'>def</span> <span class='id identifier rubyid_context'>context</span>
  <span class='ivar'>@context</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="end_time=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="end_time-instance_method">
  
    #<strong>end_time</strong>  &#x21d2; <tt>Time</tt><sup>?</sup> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The end time of the span. On the client side, this is the time kept by the
local machine where the span execution ends. On the server side, this is
the time when the server application handler stops running.</p>

<p>In Ruby, this is represented by a <code>Time</code> object in UTC, or
<code>nil</code> if the starting timestamp has not yet been populated.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Time</tt>, <tt>nil</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


169
170
171</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/opencensus/trace/span_builder.rb', line 169</span>

<span class='kw'>def</span> <span class='id identifier rubyid_end_time'>end_time</span>
  <span class='ivar'>@end_time</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="kind=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="kind-instance_method">
  
    #<strong>kind</strong>  &#x21d2; <tt>Symbol</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The kind of span. Can be used to specify additional relationships between
spans in addition to a parent/child relationship. Valid values are
<span class='object_link'><a href="#CLIENT-constant" title="OpenCensus::Trace::SpanBuilder::CLIENT (constant)">CLIENT</a></span>,
<span class='object_link'><a href="#SERVER-constant" title="OpenCensus::Trace::SpanBuilder::SERVER (constant)">SERVER</a></span>, and
<span class='object_link'><a href="#SPAN_KIND_UNSPECIFIED-constant" title="OpenCensus::Trace::SpanBuilder::SPAN_KIND_UNSPECIFIED (constant)">SPAN_KIND_UNSPECIFIED</a></span>.</p>

<p>This field is required.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


144
145
146</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/opencensus/trace/span_builder.rb', line 144</span>

<span class='kw'>def</span> <span class='id identifier rubyid_kind'>kind</span>
  <span class='ivar'>@kind</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="name=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="name-instance_method">
  
    #<strong>name</strong>  &#x21d2; <tt>String</tt>, <tt><span class='object_link'><a href="TruncatableString.html" title="OpenCensus::Trace::TruncatableString (class)">TruncatableString</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>A description of the span&#39;s operation.</p>

<p>For example, the name can be a qualified method name or a file name and a
line number where the operation is called. A best practice is to use the
same display name at the same call point in an application. This makes it
easier to correlate spans in different traces.</p>

<p>This field is required.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>, <tt><span class='object_link'><a href="TruncatableString.html" title="OpenCensus::Trace::TruncatableString (class)">TruncatableString</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


131
132
133</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/opencensus/trace/span_builder.rb', line 131</span>

<span class='kw'>def</span> <span class='id identifier rubyid_name'>name</span>
  <span class='ivar'>@name</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="start_time=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="start_time-instance_method">
  
    #<strong>start_time</strong>  &#x21d2; <tt>Time</tt><sup>?</sup> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The start time of the span. On the client side, this is the time kept by
the local machine where the span execution starts. On the server side, this
is the time when the server&#39;s application handler starts running.</p>

<p>In Ruby, this is represented by a Time object in UTC, or <code>nil</code>
if the starting timestamp has not yet been populated.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Time</tt>, <tt>nil</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


157
158
159</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/opencensus/trace/span_builder.rb', line 157</span>

<span class='kw'>def</span> <span class='id identifier rubyid_start_time'>start_time</span>
  <span class='ivar'>@start_time</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="finish!-instance_method">
  
    #<strong>finish!</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Finish this span by setting the end time to the current time. Raises an
exception if the start time is not yet set, or the end time is already set.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


195
196
197
198
199
200</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/opencensus/trace/span_builder.rb', line 195</span>

<span class='kw'>def</span> <span class='id identifier rubyid_finish!'>finish!</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Span not yet started</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_start_time'>start_time</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Span already finished</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_end_time'>end_time</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='ivar'>@end_time</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='period'>.</span><span class='id identifier rubyid_utc'>utc</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="finished?-instance_method">
  
    #<strong>finished?</strong>  &#x21d2; <tt>boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Whether this span is finished (i.e. has both a start and end time)</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


176
177
178</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/opencensus/trace/span_builder.rb', line 176</span>

<span class='kw'>def</span> <span class='id identifier rubyid_finished?'>finished?</span>
  <span class='op'>!</span><span class='id identifier rubyid_start_time'>start_time</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_end_time'>end_time</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="parent_span_id-instance_method">
  
    #<strong>parent_span_id</strong>  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The span ID of the parent, as a 16-character hex string, or the empty
string if this is a root span.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


105
106
107</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/opencensus/trace/span_builder.rb', line 105</span>

<span class='kw'>def</span> <span class='id identifier rubyid_parent_span_id'>parent_span_id</span>
  <span class='id identifier rubyid_context'>context</span><span class='period'>.</span><span class='id identifier rubyid_parent'>parent</span><span class='period'>.</span><span class='id identifier rubyid_span_id'>span_id</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="put_annotation-instance_method">
  
    #<strong>put_annotation</strong>(description, attributes = {}, time: nil)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Add an event annotation with a timestamp.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>description</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Description of the event</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>attributes</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Key-value pairs providing additional properties of the event. Keys must be
strings, and values are restricted to the same types as attributes (see
#put_attribute).</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>time</span>
      
      
        <span class='type'>(<tt>Time</tt>, <tt>nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Timestamp of the event. Optional, defaults to the current time.</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


232
233
234
235
236
237</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/opencensus/trace/span_builder.rb', line 232</span>

<span class='kw'>def</span> <span class='id identifier rubyid_put_annotation'>put_annotation</span> <span class='id identifier rubyid_description'>description</span><span class='comma'>,</span> <span class='id identifier rubyid_attributes'>attributes</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='label'>time:</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_time'>time</span> <span class='op'>||=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='period'>.</span><span class='id identifier rubyid_utc'>utc</span>
  <span class='id identifier rubyid_annotation'>annotation</span> <span class='op'>=</span> <span class='const'>AnnotationBuilder</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_time'>time</span><span class='comma'>,</span> <span class='id identifier rubyid_description'>description</span><span class='comma'>,</span> <span class='id identifier rubyid_attributes'>attributes</span>
  <span class='ivar'>@annotations</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_annotation'>annotation</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="put_attribute-instance_method">
  
    #<strong>put_attribute</strong>(key, value)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Add an attribute to this span.</p>

<p>Attributes are key-value pairs representing properties of this span. You
could, for example, add an attribute indicating the URL for the request
being handled, the user-agent, the database query being run, the ID of the
logged-in user, or any other relevant information.</p>

<p>Keys must be strings. Values may be String, TruncatableString, Integer,
Float or Boolean. The valid integer range is 64-bit signed
<code>(-2^63..2^63-1)</code>.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>key</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt>Symbol</tt>)</span>
      
      
      
    </li>
  
    <li>
      
        <span class='name'>value</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt><span class='object_link'><a href="TruncatableString.html" title="OpenCensus::Trace::TruncatableString (class)">TruncatableString</a></span></tt>, <tt>Integer</tt>, <tt>Float</tt>, <tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


217
218
219
220</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/opencensus/trace/span_builder.rb', line 217</span>

<span class='kw'>def</span> <span class='id identifier rubyid_put_attribute'>put_attribute</span> <span class='id identifier rubyid_key'>key</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span>
  <span class='ivar'>@attributes</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="put_link-instance_method">
  
    #<strong>put_link</strong>(trace_id, span_id, type, attributes = {})  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Add a pointer from the current span to another span, which may be in the
same trace or in a different trace. For example, this can be used in
batching operations, where a single batch handler processes multiple
requests from different traces or when the handler receives a request from
a different project.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>trace_id</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The unique identifier for a trace. A 16-byte array expressed as 32 hex
digits.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>span_id</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The unique identifier for a span within a trace. An 8-byte array expressed
as 16 hex digits.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>type</span>
      
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The relationship of the current span relative to the linked span. Valid
values are <span class='object_link'><a href="#CHILD_LINKED_SPAN-constant" title="OpenCensus::Trace::SpanBuilder::CHILD_LINKED_SPAN (constant)">CHILD_LINKED_SPAN</a></span>,
<span class='object_link'><a href="#PARENT_LINKED_SPAN-constant" title="OpenCensus::Trace::SpanBuilder::PARENT_LINKED_SPAN (constant)">PARENT_LINKED_SPAN</a></span>, and
<span class='object_link'><a href="#TYPE_UNSPECIFIED-constant" title="OpenCensus::Trace::SpanBuilder::TYPE_UNSPECIFIED (constant)">TYPE_UNSPECIFIED</a></span>.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>attributes</span>
      
      
        <span class='type'>(<tt>Hash&lt;String, (<span class='object_link'><a href="TruncatableString.html" title="OpenCensus::Trace::TruncatableString (class)">TruncatableString</a></span>, Integer, Float, Boolean)&gt;</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>Key-value pairs providing additional properties of the link. Keys must be
strings, and values are restricted to the same types as attributes (see
#put_attribute).</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


290
291
292
293
294</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/opencensus/trace/span_builder.rb', line 290</span>

<span class='kw'>def</span> <span class='id identifier rubyid_put_link'>put_link</span> <span class='id identifier rubyid_trace_id'>trace_id</span><span class='comma'>,</span> <span class='id identifier rubyid_span_id'>span_id</span><span class='comma'>,</span> <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_attributes'>attributes</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_link'>link</span> <span class='op'>=</span> <span class='const'>LinkBuilder</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_trace_id'>trace_id</span><span class='comma'>,</span> <span class='id identifier rubyid_span_id'>span_id</span><span class='comma'>,</span> <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_attributes'>attributes</span>
  <span class='ivar'>@links</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_link'>link</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="put_message_event-instance_method">
  
    #<strong>put_message_event</strong>(type, id, uncompressed_size, compressed_size: nil, time: nil)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Add an event describing a message sent/received between spans.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>type</span>
      
      
        <span class='type'>(<tt>Symbol</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The type of MessageEvent. Indicates whether the message was sent or
received. Valid values are <span class='object_link'><a href="#SENT-constant" title="OpenCensus::Trace::SpanBuilder::SENT (constant)">SENT</a></span>,
<span class='object_link'><a href="#RECEIVED-constant" title="OpenCensus::Trace::SpanBuilder::RECEIVED (constant)">RECEIVED</a></span>, and
<span class='object_link'><a href="#TYPE_UNSPECIFIED-constant" title="OpenCensus::Trace::SpanBuilder::TYPE_UNSPECIFIED (constant)">TYPE_UNSPECIFIED</a></span>.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>id</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>An identifier for the MessageEvent&#39;s message that can be used to match
SENT and RECEIVED events. For example, this field could represent a
sequence ID for a streaming RPC. It is recommended to be unique within a
span. The valid range is 64-bit unsigned <code>(0..2^64-1)</code></p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>uncompressed_size</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The number of uncompressed bytes sent or received.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>compressed_size</span>
      
      
        <span class='type'>(<tt>Integer</tt>, <tt>nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The number of compressed bytes sent or received. Optional.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>time</span>
      
      
        <span class='type'>(<tt>Time</tt>, <tt>nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Timestamp of the event. Optional, defaults to the current time.</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


259
260
261
262
263
264
265
266
267</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/opencensus/trace/span_builder.rb', line 259</span>

<span class='kw'>def</span> <span class='id identifier rubyid_put_message_event'>put_message_event</span> <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='id identifier rubyid_uncompressed_size'>uncompressed_size</span><span class='comma'>,</span>
                      <span class='label'>compressed_size:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>time:</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_time'>time</span> <span class='op'>||=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='period'>.</span><span class='id identifier rubyid_utc'>utc</span>
  <span class='id identifier rubyid_message_event'>message_event</span> <span class='op'>=</span>
    <span class='const'>MessageEventBuilder</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_time'>time</span><span class='comma'>,</span> <span class='id identifier rubyid_type'>type</span><span class='comma'>,</span> <span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='id identifier rubyid_uncompressed_size'>uncompressed_size</span><span class='comma'>,</span>
                            <span class='id identifier rubyid_compressed_size'>compressed_size</span>
  <span class='ivar'>@message_events</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_message_event'>message_event</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="sampled?-instance_method">
  
    #<strong>sampled?</strong>  &#x21d2; <tt>boolean</tt> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='sampled-instance_method'>sampled</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Sampling decision for this span.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


114
115
116</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/opencensus/trace/span_builder.rb', line 114</span>

<span class='kw'>def</span> <span class='id identifier rubyid_sampled?'>sampled?</span>
  <span class='id identifier rubyid_context'>context</span><span class='period'>.</span><span class='id identifier rubyid_sampled?'>sampled?</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="set_http_status-instance_method">
  
    #<strong>set_http_status</strong>(code, message = &quot;&quot;)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Set the optional final status for the span using an http status code.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>code</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>HTTP status code as a 32-bit signed integer</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>message</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&quot;&quot;</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>A developer-facing error message, which should be in English.</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


316
317
318</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/opencensus/trace/span_builder.rb', line 316</span>

<span class='kw'>def</span> <span class='id identifier rubyid_set_http_status'>set_http_status</span> <span class='id identifier rubyid_code'>code</span><span class='comma'>,</span> <span class='id identifier rubyid_message'>message</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_set_status'>set_status</span> <span class='id identifier rubyid_map_http_status'>map_http_status</span><span class='lparen'>(</span><span class='id identifier rubyid_code'>code</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_message'>message</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="set_status-instance_method">
  
    #<strong>set_status</strong>(code, message = &quot;&quot;)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Set the optional final status for the span.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>code</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Status code as a 32-bit signed integer</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>message</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&quot;&quot;</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>A developer-facing error message, which should be in English.</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


303
304
305
306
307</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/opencensus/trace/span_builder.rb', line 303</span>

<span class='kw'>def</span> <span class='id identifier rubyid_set_status'>set_status</span> <span class='id identifier rubyid_code'>code</span><span class='comma'>,</span> <span class='id identifier rubyid_message'>message</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span>
  <span class='ivar'>@status_code</span> <span class='op'>=</span> <span class='id identifier rubyid_code'>code</span>
  <span class='ivar'>@status_message</span> <span class='op'>=</span> <span class='id identifier rubyid_message'>message</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="span_id-instance_method">
  
    #<strong>span_id</strong>  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The span ID, as a 16-character hex string.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


95
96
97</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/opencensus/trace/span_builder.rb', line 95</span>

<span class='kw'>def</span> <span class='id identifier rubyid_span_id'>span_id</span>
  <span class='id identifier rubyid_context'>context</span><span class='period'>.</span><span class='id identifier rubyid_span_id'>span_id</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="start!-instance_method">
  
    #<strong>start!</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Start this span by setting the start time to the current time. Raises an
exception if the start time is already set.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


184
185
186
187
188</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/opencensus/trace/span_builder.rb', line 184</span>

<span class='kw'>def</span> <span class='id identifier rubyid_start!'>start!</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Span already started</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_start_time'>start_time</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='ivar'>@start_time</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='period'>.</span><span class='id identifier rubyid_utc'>utc</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="to_span-instance_method">
  
    #<strong>to_span</strong>(max_attributes: nil, max_stack_frames: nil, max_annotations: nil, max_message_events: nil, max_links: nil, max_string_length: nil, child_span_count: nil)  &#x21d2; <tt><span class='object_link'><a href="Span.html" title="OpenCensus::Trace::Span (class)">Span</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Return a read-only version of this span</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>max_attributes</span>
      
      
        <span class='type'>(<tt>Integer</tt>, <tt>nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The maximum number of attributes to save, or <code>nil</code> to use the
config value.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>max_stack_frames</span>
      
      
        <span class='type'>(<tt>Integer</tt>, <tt>nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The maximum number of stack frames to save, or <code>nil</code> to use the
config value.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>max_annotations</span>
      
      
        <span class='type'>(<tt>Integer</tt>, <tt>nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The maximum number of annotations to save, or <code>nil</code> to use the
config value.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>max_message_events</span>
      
      
        <span class='type'>(<tt>Integer</tt>, <tt>nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The maximum number of message events to save, or <code>nil</code> to use
the config value.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>max_links</span>
      
      
        <span class='type'>(<tt>Integer</tt>, <tt>nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The maximum number of links to save, or <code>nil</code> to use the config
value.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>max_string_length</span>
      
      
        <span class='type'>(<tt>Integer</tt>, <tt>nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The maximum length in bytes for truncated strings, or <code>nil</code> to
use the config value.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>child_span_count</span>
      
      
        <span class='type'>(<tt>Integer</tt>, <tt>nil</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>The number of child spans to declare, or <code>nil</code> to omit the
<code>child_span_count</code> field.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Span.html" title="OpenCensus::Trace::Span (class)">Span</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/opencensus/trace/span_builder.rb', line 368</span>

<span class='kw'>def</span> <span class='id identifier rubyid_to_span'>to_span</span> <span class='label'>max_attributes:</span> <span class='kw'>nil</span><span class='comma'>,</span>
            <span class='label'>max_stack_frames:</span> <span class='kw'>nil</span><span class='comma'>,</span>
            <span class='label'>max_annotations:</span> <span class='kw'>nil</span><span class='comma'>,</span>
            <span class='label'>max_message_events:</span> <span class='kw'>nil</span><span class='comma'>,</span>
            <span class='label'>max_links:</span> <span class='kw'>nil</span><span class='comma'>,</span>
            <span class='label'>max_string_length:</span> <span class='kw'>nil</span><span class='comma'>,</span>
            <span class='label'>child_span_count:</span> <span class='kw'>nil</span>

  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Span must have start_time</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='ivar'>@start_time</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Span must have end_time</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='ivar'>@end_time</span>

  <span class='id identifier rubyid_builder'>builder</span> <span class='op'>=</span> <span class='const'>PieceBuilder</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='label'>max_attributes:</span> <span class='id identifier rubyid_max_attributes'>max_attributes</span><span class='comma'>,</span>
                             <span class='label'>max_stack_frames:</span> <span class='id identifier rubyid_max_stack_frames'>max_stack_frames</span><span class='comma'>,</span>
                             <span class='label'>max_annotations:</span> <span class='id identifier rubyid_max_annotations'>max_annotations</span><span class='comma'>,</span>
                             <span class='label'>max_message_events:</span> <span class='id identifier rubyid_max_message_events'>max_message_events</span><span class='comma'>,</span>
                             <span class='label'>max_links:</span> <span class='id identifier rubyid_max_links'>max_links</span><span class='comma'>,</span>
                             <span class='label'>max_string_length:</span> <span class='id identifier rubyid_max_string_length'>max_string_length</span>

  <span class='id identifier rubyid_built_name'>built_name</span> <span class='op'>=</span> <span class='id identifier rubyid_builder'>builder</span><span class='period'>.</span><span class='id identifier rubyid_truncatable_string'>truncatable_string</span> <span class='id identifier rubyid_name'>name</span>
  <span class='id identifier rubyid_built_attributes'>built_attributes</span> <span class='op'>=</span> <span class='id identifier rubyid_builder'>builder</span><span class='period'>.</span><span class='id identifier rubyid_convert_attributes'>convert_attributes</span> <span class='ivar'>@attributes</span>
  <span class='id identifier rubyid_dropped_attributes_count'>dropped_attributes_count</span> <span class='op'>=</span> <span class='ivar'>@attributes</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>-</span> <span class='id identifier rubyid_built_attributes'>built_attributes</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span>
  <span class='id identifier rubyid_built_stack_trace'>built_stack_trace</span> <span class='op'>=</span> <span class='id identifier rubyid_builder'>builder</span><span class='period'>.</span><span class='id identifier rubyid_truncate_stack_trace'>truncate_stack_trace</span> <span class='ivar'>@stack_trace</span>
  <span class='id identifier rubyid_dropped_frames_count'>dropped_frames_count</span> <span class='op'>=</span> <span class='ivar'>@stack_trace</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>-</span> <span class='id identifier rubyid_built_stack_trace'>built_stack_trace</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span>
  <span class='id identifier rubyid_built_annotations'>built_annotations</span> <span class='op'>=</span> <span class='id identifier rubyid_builder'>builder</span><span class='period'>.</span><span class='id identifier rubyid_convert_annotations'>convert_annotations</span> <span class='ivar'>@annotations</span>
  <span class='id identifier rubyid_dropped_annotations_count'>dropped_annotations_count</span> <span class='op'>=</span> <span class='ivar'>@annotations</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>-</span> <span class='id identifier rubyid_built_annotations'>built_annotations</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span>
  <span class='id identifier rubyid_built_message_events'>built_message_events</span> <span class='op'>=</span> <span class='id identifier rubyid_builder'>builder</span><span class='period'>.</span><span class='id identifier rubyid_convert_message_events'>convert_message_events</span> <span class='ivar'>@message_events</span>
  <span class='id identifier rubyid_dropped_message_events_count'>dropped_message_events_count</span> <span class='op'>=</span>
    <span class='ivar'>@message_events</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>-</span> <span class='id identifier rubyid_built_message_events'>built_message_events</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span>
  <span class='id identifier rubyid_built_links'>built_links</span> <span class='op'>=</span> <span class='id identifier rubyid_builder'>builder</span><span class='period'>.</span><span class='id identifier rubyid_convert_links'>convert_links</span> <span class='ivar'>@links</span>
  <span class='id identifier rubyid_dropped_links_count'>dropped_links_count</span> <span class='op'>=</span> <span class='ivar'>@links</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>-</span> <span class='id identifier rubyid_built_links'>built_links</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span>
  <span class='id identifier rubyid_built_status'>built_status</span> <span class='op'>=</span> <span class='id identifier rubyid_builder'>builder</span><span class='period'>.</span><span class='id identifier rubyid_convert_status'>convert_status</span> <span class='ivar'>@status_code</span><span class='comma'>,</span> <span class='ivar'>@status_message</span>
  <span class='id identifier rubyid_same_process_as_parent_span'>same_process_as_parent_span</span> <span class='op'>=</span> <span class='id identifier rubyid_context'>context</span><span class='period'>.</span><span class='id identifier rubyid_parent'>parent</span><span class='period'>.</span><span class='id identifier rubyid_same_process_as_parent'>same_process_as_parent</span>

  <span class='const'><span class='object_link'><a href="Span.html" title="OpenCensus::Trace::Span (class)">Span</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_trace_id'>trace_id</span><span class='comma'>,</span> <span class='id identifier rubyid_span_id'>span_id</span><span class='comma'>,</span> <span class='id identifier rubyid_built_name'>built_name</span><span class='comma'>,</span> <span class='ivar'>@start_time</span><span class='comma'>,</span> <span class='ivar'>@end_time</span><span class='comma'>,</span>
           <span class='label'>kind:</span> <span class='ivar'>@kind</span><span class='comma'>,</span>
           <span class='label'>parent_span_id:</span> <span class='id identifier rubyid_parent_span_id'>parent_span_id</span><span class='comma'>,</span>
           <span class='label'>attributes:</span> <span class='id identifier rubyid_built_attributes'>built_attributes</span><span class='comma'>,</span>
           <span class='label'>dropped_attributes_count:</span> <span class='id identifier rubyid_dropped_attributes_count'>dropped_attributes_count</span><span class='comma'>,</span>
           <span class='label'>stack_trace:</span> <span class='id identifier rubyid_built_stack_trace'>built_stack_trace</span><span class='comma'>,</span>
           <span class='label'>dropped_frames_count:</span> <span class='id identifier rubyid_dropped_frames_count'>dropped_frames_count</span><span class='comma'>,</span>
           <span class='label'>time_events:</span> <span class='id identifier rubyid_built_annotations'>built_annotations</span> <span class='op'>+</span> <span class='id identifier rubyid_built_message_events'>built_message_events</span><span class='comma'>,</span>
           <span class='label'>dropped_annotations_count:</span> <span class='id identifier rubyid_dropped_annotations_count'>dropped_annotations_count</span><span class='comma'>,</span>
           <span class='label'>dropped_message_events_count:</span> <span class='id identifier rubyid_dropped_message_events_count'>dropped_message_events_count</span><span class='comma'>,</span>
           <span class='label'>links:</span> <span class='id identifier rubyid_built_links'>built_links</span><span class='comma'>,</span>
           <span class='label'>dropped_links_count:</span> <span class='id identifier rubyid_dropped_links_count'>dropped_links_count</span><span class='comma'>,</span>
           <span class='label'>status:</span> <span class='id identifier rubyid_built_status'>built_status</span><span class='comma'>,</span>
           <span class='label'>same_process_as_parent_span:</span> <span class='id identifier rubyid_same_process_as_parent_span'>same_process_as_parent_span</span><span class='comma'>,</span>
           <span class='label'>child_span_count:</span> <span class='id identifier rubyid_child_span_count'>child_span_count</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="trace_id-instance_method">
  
    #<strong>trace_id</strong>  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The trace ID, as a 32-character hex string.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


86
87
88</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/opencensus/trace/span_builder.rb', line 86</span>

<span class='kw'>def</span> <span class='id identifier rubyid_trace_id'>trace_id</span>
  <span class='id identifier rubyid_context'>context</span><span class='period'>.</span><span class='id identifier rubyid_trace_id'>trace_id</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="update_stack_trace-instance_method">
  
    #<strong>update_stack_trace</strong>(stack_trace = 0)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Set the stack trace for this span.</p>

<p>You may call this in one of three ways: * Pass in no argument to use the
caller&#39;s stack trace. * Pass in an integer to use the caller&#39;s
stack trace, but skip  additional stack frames. * Pass in an explicit array
of <code>Thread::Backtrace::Location</code> as  returned from
<code>Kernel#caller_locations</code></p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>stack_trace</span>
      
      
        <span class='type'>(<tt>Array&lt;Thread::Backtrace::Location&gt;</tt>, <tt>Integer</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>0</tt>)</em>
      
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


332
333
334
335
336
337
338
339
340
341
342
343</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/opencensus/trace/span_builder.rb', line 332</span>

<span class='kw'>def</span> <span class='id identifier rubyid_update_stack_trace'>update_stack_trace</span> <span class='id identifier rubyid_stack_trace'>stack_trace</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='ivar'>@stack_trace</span> <span class='op'>=</span>
    <span class='kw'>case</span> <span class='id identifier rubyid_stack_trace'>stack_trace</span>
    <span class='kw'>when</span> <span class='const'>Integer</span>
      <span class='id identifier rubyid_caller_locations'>caller_locations</span><span class='lparen'>(</span><span class='id identifier rubyid_stack_trace'>stack_trace</span> <span class='op'>+</span> <span class='int'>2</span><span class='rparen'>)</span>
    <span class='kw'>when</span> <span class='const'>Array</span>
      <span class='id identifier rubyid_stack_trace'>stack_trace</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Unknown stack trace type: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_stack_trace'>stack_trace</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>self</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Mon Oct 14 17:55:23 2019 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.20 (ruby-2.5.3).
</div>

    </div>
  </body>
</html>